import personas.*
import financieros.*
import abstractos.*
describe "Tests"{
    method pepita(){
        const tarjeta = new Credito(bancoEmisor = new Banco(cuotas = 5, tope = 1000))
        const pepita = new Persona(
            pagoPreferido = tarjeta,
            trabajo = new Empleo(salario = 1000),
            credito = [tarjeta]
        )
        const heladera = new Articulo(precio = 10, nombre = "heladera")
        pepita.comprar(heladera)
        return pepita}
    test "Compra en cuotas"{
        const pepita = self.pepita()

        mes.pasarMes()
        mes.pasarMes() //Paso meses sin que pepita cobre, para que acumule deudas
        assert.equals(pepita.cuotasAPagar().sum{x => x.valor()}, 6)
    }

    test "Pepita es la que mÃ¡s tiene"{
        const pepita = self.pepita()
        universo.personas().add(pepita)
        assert.equals(universo.personaConMasCosas(), pepita)
    }

    test "Pepita paga cuotas"{
        const pepita = self.pepita()
        universo.personas().add(pepita)
        universo.transcurreMes()
        assert.equals(pepita.cuotasAPagar().sum{x => x.valor()}, 0)
    }
    test "Pepita paga no cuotas porque es no cobra lo suficiente"{
        const pepita = self.pepita()
        pepita.trabajo(new Empleo(salario = 2))
        universo.personas().add(pepita)
        universo.transcurreMes()
        assert.equals(pepita.cuotasAPagar().sum{x => x.valor()}, 3)
    }
}